# wpm_uncertainty

**This repository includes all Python codes related to the paper:**

* Luca Giaccone, *"Uncertainty quantification in the assessment of human exposure to pulsed or multi-frequency fields"*, Physics in Medicine & Biology, [10.1088/1361-6560/acc924](https://doi.org/10.1088/1361-6560/acc924)

**Abstract of the paper:**

<ins>Objective</ins>: pulsed fields or waveforms with multi-frequency content have to be assessed with suitable methods. This paper deals with the uncertainty quantification associated to these methods. <ins>Approach</ins>: among all possible approaches, the weighted peak method is widely employed in standards and guidelines, therefore, in this paper, we consider its implementation both in time domain and frequency domain. For the uncertainty quantification the polynomial chaos expansion theory is used. By means of a sensitivity analysis, for several standard waveforms, the parameters with more influence on the exposure index are identified and their sensitivity indices are quantified. The output of the sensitivity analysis is used to set up a parametric analysis with the aim of evaluating the uncertainty propagation of the analyzed methods and, finally, also several measured waveforms generated by a welding gun are tested. <ins>Main findings</ins>: it is shown that the time domain implementation of the weighted peak method provides results in agreement with the basilar mechanisms of electromagnetic induction and electrostimulation. On the opposite, the WPM in frequency domain is found to be too sensitive to parameters that should not influence the exposure index because its weight function includes sharp variations of the phase centered on real zeros and poles. To overcome this issue, a new definition for the phase of the weight function in frequency domain is proposed. <ins>Significance</ins>: it is shown that the time domain implementation of the weighted peak method is the more accurate and precise. The standard WPM in frequency domain has some issues that can be avoided with the proposed modification of the phase definition of the weight function. Finally, all the codes used in this paper are hosted on a GitHub and can be freely accessed at [https://github.com/giaccone/wpm_uncertainty](https://github.com/giaccone/wpm_uncertainty).


*Submission dates:*

1. Received 3 January 2023
2. Revised 17 March 2023
3. Accepted 30 March 2023
4. Accepted Manuscript online 30 March 2023


## 1. Requirements

### 1.1 Python version
All codes have been tested with Python 3.9 and 3.10.

### 1.2 Python modules (available on conda and/or Pypi)

In order to run the Python codes the following modules are required:

* numpy (available on conda and Pypi)
* scipy (available on conda and Pypi)
* matplotlib (available on conda and Pypi)
* progress (available on conda and Pypi)
* joblib (available on conda and Pypi)
* pce (available Pypi, see here for more details: [https://github.com/giaccone/pce](https://github.com/giaccone/pce))

### 1.3 Other Python (non-packaged) projects
Finally, other Python codes are used in this repository that are not available on Pypy. It is necessary to download them and setup the interpreter in order to make them accessible in the path. This is the list of the required repositories:

* [https://github.com/giaccone/fourier](https://github.com/giaccone/fourier)
* [https://github.com/giaccone/exposure](https://github.com/giaccone/exposure)

## 2. Usage

First of all:

* clone the repository (`git clone https://github.com/giaccone/wpm_uncertainty`)
* read the file `currents.txt` (included in the `currents` folder). It includes instructions about how to download the measured data.

Afterward:

* activate a Python environment with the requirements described in section 1

Finally:

* each script on the repository can be executed